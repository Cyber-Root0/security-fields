!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).SecurityForm=e()}(this,(function(){"use strict";class t{constructor(t,e={}){this.containerId=t,this.iframe=null,this.config=e,this.init()}addBody(t){return this.iframe.srcdoc=`\n          <!DOCTYPE html>\n          <html lang="pt-br">\n          <head>\n            <meta charset="UTF-8">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n          </head>\n          <body>\n            <form action='/unknown' id='form1'>\n                ${t.innerHTML}\n            </form>\n            <script>\n              const form = document.getElementById('form1');\n              form.addEventListener('submit', function(e) {\n                e.preventDefault();\n                const formData = new FormData(form);\n                const data = {};\n                formData.forEach((value, key) => {\n                  data[key] = value;\n                });\n                fetch('${this.config.url}', {\n                  method: '${this.config.method}', \n                  headers: ${JSON.stringify(this.config.headers)},\n                  body: JSON.stringify(data),\n                })\n                .then(response => response.json())\n                .then(data => {\n                  window.parent.postMessage({ status: 'success', data: data }, '*');\n                })\n                .catch(error => {\n                  window.parent.postMessage({ status: 'fail', message: error.message }, '*');\n                });\n              });\n            <\/script>\n          </body>\n          </html>\n        `,this}init(){this.iframe=document.createElement("iframe"),this.iframe.style.border="none",this.iframe.style.width="100%",this.iframe.style.height="40px",this.iframe.sandbox="allow-scripts allow-forms"}execute(){const t=document.getElementById(this.containerId);if(!t)throw new Error(`Container com ID '${this.containerId}' nÃ£o encontrado.`);t.appendChild(this.iframe)}}class e{constructor(t){this.config=t,this.uid=null}execute(e,n,s){new t(n,this.config).addBody(e).execute(),this.listening(s)}listening(t){this.uid=t,window.addEventListener("message",(t=>{"success"===t.data.status?this.dispatchEvent({status:"success",message:t.data.data}):"fail"===t.data.status&&this.dispatchEvent({status:"error",message:t.data.message})}),!1)}dispatchEvent(t){const e=new CustomEvent(this.uid,{detail:t});window.dispatchEvent(e)}}class n{clone(t){const e=document.getElementById(t),n=e.cloneNode(!0);return e.style.display="none",n}}return class{constructor(t,e){this.configs={},this.formID=t,this.containerID=e,this.clone=new n}config(t,e="POST",n={}){return this.configs={url:t,method:e||"post",headers:n||{}},this}extract(){return this.clone.clone(this.formID)}build(){const t=this.generateUID(),n=new e(this.configs),s=this.extract();return n.execute(s,this.containerID,t),t}generateUID(){return Math.random().toString(36).slice(-6)}}}));
